#!/usr/bin/env bash

set -euo pipefail

function luver_list-remote() {
  local tool="${1:-"lua"}"
  if [[ " lua luarocks " != *" ${tool} "* ]]; then
    echo "unsupported tool: ${tool}"
    exit 1
  fi

  case "${tool}" in
    lua)
      local -ar versions=($(curl -fSsL https://www.lua.org/ftp | sed -n "s/.*>lua-\(.*\..*\).tar.gz<.*/\1/p" | sort))
      for version in ${versions[@]}; do
        echo "${version}"
      done
      ;;
    luarocks)
      local -ar versions=($(curl -fSsL http://luarocks.github.io/luarocks/releases | sed -n "s/.*>luarocks-\(.*\..*\).tar.gz<.*/\1/p" | sort))
      for version in ${versions[@]}; do
        echo "${version}"
      done
      ;;
  esac
}

luver_list-remote $@
