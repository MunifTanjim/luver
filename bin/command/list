#!/usr/bin/env bash

set -euo pipefail

source "${LUVER_SRC}/bin/command/_utils.sh"

function luver_list() {
  local -A map

  local current_version="$(${LUVER_SRC}/bin/command/current)"

  local version
  for version in $(luver_list_version); do
    map[${version}]=""
  done

  local aliasmap alias
  for aliasmap in $(luver_list_aliasmap); do
    alias="$(echo ${aliasmap} | cut -d: -f1)"
    version="$(echo ${aliasmap} | cut -d: -f2)"
    map[${version}]="${map[${version}]} ${alias}"
  done

  local mark=""
  for version in $(printf '%s\n' ${!map[@]} | sort); do
    if test "${version}" = "${current_version}"; then
      mark=" *"
    fi

    echo "${version}${map[${version}]}${mark}"

    mark=""
  done
}

luver_list $@
